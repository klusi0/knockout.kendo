//knockout.kendo v0.1.0 | (c) 2012 Tomasz Miku≈õ | http://www.opensource.org/licenses/mit-license
(function(a,b,c){a.bindingHandlers.kendoAutoComplete={init:function(c,d,e,f){var g=b.extend({css:{},dataSource:[],dataTextField:null,dataValueField:null,enable:true,event:{change:null,close:null,open:null,select:null},filter:"startswith",height:200,highlightFirst:true,ignoreCase:true,minLength:1,placeholder:"",separator:"",suggest:false,value:null},d());var h=g.dataTextField==null?function(a){return a}:function(a){return a[g.dataTextField]};var i=g.dataValueField==null?function(a){return a}:function(a){return a[g.dataValueField]};var j=null;var k=null;var l=function(a){var b=k.total();for(var c=0;c<b;c++){if(i(k.at(c))==a){j.value(h(k.at(c)));break}}};var m=g.value;var n=b(c);if(m!=null){if(a.isObservable(m)){m.subscribe(function(a){l(a)});m=m()}}if(a.isObservable(g.dataSource)){k=new kendo.data.DataSource({data:g.dataSource()});g.dataSource.subscribe(function(a){k.cancelChanges();for(var b=0;b<a.length;b++){k.add(a[b])}l(m);j.popup.open()})}else if(b.isArray(g.dataSource)){k=new kendo.data.DataSource({data:g.dataSource})}else{k=g.dataSource}j=n.kendoAutoComplete({dataSource:k,dataTextField:g.dataTextField,enable:g.enable,filter:g.filter,height:g.height,highlightFirst:g.highlightFirst,ignoreCase:g.ignoreCase,minLength:g.minLength,placeholder:g.placeholder,separator:g.separator,suggest:g.suggest}).data("kendoAutoComplete");n.on("removing",function(){(j.popup.wrapper[0]?j.popup.wrapper:j.popup.element).remove();j.element.show().insertBefore(j.wrapper);j.wrapper.remove();j.element.removeData("kendoComboBox")});l(m);if(g.value!=null&&a.isObservable(g.value)){j.bind("select",function(a){if(!a){g.value(null)}var b=a.item[0];var c=j.ul[0].children;var d=c.length;for(var e=0;e<d;e++){if(b==c[e]){g.value(j._data()[e]);break}}})}if(g.event.change!=null){j.bind("change",g.event.change)}if(g.event.close!=null){j.bind("close",g.event.close)}if(g.event.open!=null){j.bind("open",g.event.open)}if(g.event.select!=null){j.bind("select",g.event.select)}var o=b(j.element).parent();for(var p in g.css){var q=g.css[p];if(a.isObservable(q)){q()?o.addClass(p):o.removeClass(p);q.subscribe(function(a){a?o.addClass(p):o.removeClass(p)})}else{q?o.addClass(p):o.removeClass(p)}}}};a.bindingHandlers.kendoComboBox={init:function(c,d,e,f){var g=b.extend({animation:false,css:{},dataSource:[],dataTextField:null,dataValueField:null,enable:true,event:{change:null,close:null,open:null,select:null},filter:"startswith",height:500,highLightFirst:true,ignoreCase:true,minLength:1,placeholder:"",separator:"",suggest:false,value:null},d());var h=g.dataTextField==null?function(a){return a}:function(a){return a[g.dataTextField]};var i=g.dataValueField==null?function(a){return a}:function(a){return a[g.dataValueField]};var j=null;var k=null;var l=function(b){var c=k.total();for(var d=0;d<c;d++){if(i(k.at(d))==b){j.value(a.utils.unwrapObservable(h(k.at(d))));break}}};var m=g.value;if(m!=null){if(a.isObservable(m)){m.subscribe(function(a){l(a)});m=m()}}var n=g.enable;if(a.isObservable(n)){n.subscribe(function(a){j.enable(a)});n=g.enable()}if(a.isObservable(g.dataSource)){k=new kendo.data.DataSource({data:g.dataSource().map(function(c){if(a.isObservable(h(c))){var d=h(c)();if(g.dataTextField==null){return d}else{var e={};e[g.dataTextField]=d;return b.extend({},c,e)}}})});g.dataSource.subscribe(function(a){k.cancelChanges();for(var b=0;b<a.length;b++){k.add(a[b])}l(m)})}else if(b.isArray(g.dataSource)){k=new kendo.data.DataSource({data:g.dataSource})}else{k=g.dataSource}j=b(c).kendoComboBox({animation:g.animation,dataSource:k,dataTextField:g.dataTextField,enable:n,filter:g.filter,height:g.height,highlightFirst:g.highlightFirst,ignoreCase:g.ignoreCase,minLength:g.minLength,placeholder:g.placeholder,separator:g.separator,suggest:g.suggest}).data("kendoComboBox");l(m);if(g.value!=null&&a.isObservable(g.value)){j.bind("select",function(a){if(!a){g.value(null)}var b=a.item[0];var c=j.ul[0].children;var d=c.length;for(var e=0;e<d;e++){if(b==c[e]){g.value(i(j._data()[e]));break}}})}if(g.event.change!=null){j.bind("change",g.event.change)}if(g.event.close!=null){j.bind("close",g.event.close)}if(g.event.open!=null){j.bind("open",g.event.open)}if(g.event.select!=null){j.bind("select",g.event.select)}var o=b(j.element).parent();for(var p in g.css){var q=g.css[p];if(a.isObservable(q)){q()?o.addClass(p):o.removeClass(p);q.subscribe(function(a){a?o.addClass(p):o.removeClass(p)})}else{q?o.addClass(p):o.removeClass(p)}}}};a.bindingHandlers.kendoDatePicker={init:function(c,d,e,f){var g=b.extend({animation:false,css:{},depth:"month",enable:true,event:{change:null,close:null,open:null},format:"MM/dd/yyyy",max:new Date(2099,11,31),min:new Date(1900,0,1),start:"month",value:null},d());var h=null;var i=g.value;if(i!=null){if(a.isObservable(i)){i.subscribe(function(a){h.value(a)});i=i()}}var j=g.enable;if(a.isObservable(j)){j.subscribe(function(a){h.enable(a)});j=g.enable()}h=b(c).kendoDatePicker({animation:g.animation,depth:g.depth,format:g.format,max:g.max,min:g.min,start:g.start,value:i}).data("kendoDatePicker");if(g.value!=null&&a.isObservable(g.value)){h.bind("change",function(a){if(!a){g.value(null)}g.value(this.value())})}if(g.event.change!=null){h.bind("change",g.event.change)}if(g.event.close!=null){h.bind("close",g.event.close)}if(g.event.open!=null){h.bind("open",g.event.open)}var k=b(h.element).parent();for(var l in g.css){var m=g.css[l];if(a.isObservable(m)){m()?k.addClass(l):k.removeClass(l);m.subscribe(function(a){a?k.addClass(l):k.removeClass(l)})}else{m?k.addClass(l):k.removeClass(l)}}}}})(ko,jQuery)